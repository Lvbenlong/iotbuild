(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f0f3e0da"],{"2c77":function(t,e,a){"use strict";a.d(e,"c",function(){return i}),a.d(e,"b",function(){return o}),a.d(e,"a",function(){return l}),a.d(e,"d",function(){return s});var n=a("8897"),r=a("751a");function i(t){return r["a"].get("".concat(n["a"].baseUrl,"/v2/alarms/").concat(t.notice_status),t)}function o(t){return r["a"].get("".concat(n["a"].baseUrl,"/v3/place/").concat(t))}function l(t,e,a,i,o,l){var s="".concat(n["a"].baseUrl,"/v2/alarms/excel?start=").concat(t,"&end=").concat(e);return a>=0&&(s+="&place_id=".concat(a)),o>=0&&(s+="&alarm_type=".concat(o)),l>=0&&(s+="&status=".concat(l)),r["a"].download(s,i)}function s(t){return r["a"].get("".concat(n["a"].baseUrl,"/v2/tasks"),t)}},5568:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"iotTable"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData}},t._l(t.tableHeader,function(e,n){return"slot"!==e.type?a("el-table-column",{key:n,attrs:{prop:e.prop,width:e.width,label:e.label}}):a("el-table-column",{key:n,attrs:{width:e.width||150,label:e.label},scopedSlots:t._u([{key:"default",fn:function(a){return[t._t("col-"+e.prop,null,{row:a.row,index:a.$index})]}}],null,!0)})}),1),t.showPage?a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{"current-page":t.pagination.page,"page-sizes":[10,20,50,100],"page-size":t.pagination.per_page,layout:"total, sizes, prev, pager, next, jumper",total:t.pagination.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1):t._e()],1)},r=[],i={name:"IotTable",props:{tableData:{type:Array,required:!0},tableHeader:{type:Array,required:!0},loading:{type:Boolean,required:!1},pagination:{type:Object,required:!1},hidepagination:{type:Boolean,required:!1,default:!1}},data:function(){return{}},computed:{showPage:function(){return!this.hidepagination&&!!this.pagination}},methods:{handleSizeChange:function(t){this.pagination.per_page=t,this.$emit("reloaddata")},handleCurrentChange:function(t){console.log(t),this.pagination.page=t,this.$emit("reloaddata")}}},o=i,l=(a("c18f"),a("2877")),s=Object(l["a"])(o,n,r,!1,null,"d6bd296c",null);e["a"]=s.exports},"5bb9":function(t,e,a){"use strict";var n=a("e201"),r=a.n(n);r.a},"84c0":function(t,e,a){},"9f84":function(t,e,a){},c18f:function(t,e,a){"use strict";var n=a("9f84"),r=a.n(n);r.a},dab0:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"titleHeader"},[a("h3",[t._v(t._s(t.title))])])},r=[],i={name:"TitleHeader",props:["title"],data:function(){return{}}},o=i,l=(a("e4fc"),a("2877")),s=Object(l["a"])(o,n,r,!1,null,"2b873fd4",null);e["a"]=s.exports},e201:function(t,e,a){},e4fc:function(t,e,a){"use strict";var n=a("84c0"),r=a.n(n);r.a},f3c3:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"malfunction"},[a("title-header",{attrs:{title:"派工单管理"}}),a("div",{staticClass:"selects"},[a("div",{staticClass:"select-titles"},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"common-item"},[t._v("工单状态")])]),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"common-item"})])],1)],1),a("div",{staticClass:"select-content"},[a("el-row",{attrs:{gutter:24}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"common-item selsct-common"},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.queryFilter.status,callback:function(e){t.$set(t.queryFilter,"status",e)},expression:"queryFilter.status"}},t._l(t.orderStatus,function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.code}})}),1)],1)]),a("el-col",{attrs:{span:8}},[a("el-button",{staticClass:"blue",attrs:{type:"primary"},on:{click:t.initData}},[t._v("查询")])],1)],1)],1)]),a("div",{staticClass:"data"},[a("iot-table",{attrs:{tableHeader:t.tableHeader,tableData:t.tableData,pagination:t.pagination,loading:t.loading},on:{reloaddata:t.initData},scopedSlots:t._u([{key:"col-alarm_type",fn:function(e){return a("div",{},[a("p",[t._v(t._s(t.alarmType(e.row.alarm_type)))])])}},{key:"col-alarm_time",fn:function(e){return a("div",{},[a("p",[t._v(t._s(t.calcTime(e.row.alarm_time)))])])}},{key:"col-create_time",fn:function(e){return a("div",{},[a("p",[t._v(t._s(t.calcTime(e.row.create_time)))])])}},{key:"col-end_time",fn:function(e){return a("div",{},[a("p",[t._v(t._s(t.calcTime(e.row.end_time)))])])}},{key:"col-status",fn:function(e){return a("div",{},[a("p",[t._v(t._s(t.pgStatus(e.row.status)))])])}},{key:"col-confirm",fn:function(e){return a("div",{},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleShowOrder(e.row)}}},[t._v("处理工单")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.handleShowStep(e.row)}}},[t._v("查看进度")])],1)}}])})],1),a("handle-order",{ref:"handleOrder",on:{"handle-success":t.initData}}),a("handle-step",{ref:"handleStep"})],1)},r=[],i=(a("96cf"),a("3b8d")),o=a("8897"),l=a("2c77"),s=a("24b9"),c=a("d721"),u=a("486b"),d=a("5568"),p=a("dab0"),f=a("3389"),m={name:"Malfunction",components:{handleOrder:c["a"],handleStep:u["a"],iotTable:d["a"],TitleHeader:p["a"]},mounted:function(){this.initData()},data:function(){return{loading:!1,queryFilter:{status:"1,2,3,4",delayAmount:0},orderStatus:[{code:"1,2,3,4",name:"全部事件"},{code:"1",name:"派单中"},{code:"2",name:"处理中"},{code:"3",name:"延迟处理"},{code:"4",name:"处理完成"}],project:{name:"",id:""},tableData:[],pagination:{page:1,per_page:10,total:0},tableHeader:[{prop:"alarm_type",label:"报警类型",type:"slot"},{prop:"address",label:"安装位置"},{prop:"alarm_time",label:"报警时间",type:"slot"},{prop:"create_time",label:"创建时间",type:"slot"},{prop:"end_time",label:"完成时间",type:"slot"},{prop:"mac",label:"设备mac"},{prop:"status",label:"派工状态",type:"slot"},{prop:"confirm",label:"操作",type:"slot"}]}},computed:{alarmType:function(){return function(t){return o["a"].alarmTypes[t]}},pgStatus:function(){return function(t){return 0===t||3===t?"".concat(0===t?"未派工":"延迟处理"):4===t?"处理完毕":"".concat(1===t?"派单中":"处理中")}},calcTime:function(){return function(t){return t?s["a"].format(new Date(1e3*t),"YYYY-MM-dd HH:mm:ss"):""}}},methods:{handleShowOrder:function(t){this.$refs.handleOrder.show(t)},handleShowStep:function(t){this.$refs.handleStep.show(t)},initData:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e,a,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return this.loading=!0,e={page:this.pagination.page,per_page:this.pagination.per_page,status:this.queryFilter.status,delay_amount:this.queryFilter.delayAmount?this.queryFilter.delayAmount:void 0,place_id:this.project.id?this.project.id:void 0},t.prev=2,t.next=5,Object(l["d"])(e);case 5:a=t.sent,n=a.data,this.tableData=n.items,this.pagination={total:n.page_info.total,page:n.page_info.page,per_page:n.page_info.per_page},this.loading=!1,t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](2),this.loading=!1,f["a"].error("查询数据失败");case 16:case"end":return t.stop()}},t,this,[[2,12]])}));function e(){return t.apply(this,arguments)}return e}()}},h=m,g=(a("5bb9"),a("2877")),b=Object(g["a"])(h,n,r,!1,null,null,null);e["default"]=b.exports}}]);
//# sourceMappingURL=chunk-f0f3e0da.534a1f76.js.map