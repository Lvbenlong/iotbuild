(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a9e1d2a"],{"00bf":function(e,t,a){"use strict";var i=a("9f96"),n=a.n(i);n.a},"02e8":function(e,t,a){},"0ec8":function(e,t,a){"use strict";var i=a("77b1"),n=a.n(i);n.a},"23b2":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"devicetype"},[a("p",{staticClass:"t"},[e._v(e._s(e.titleName)+" "),a("span",{on:{click:e.handleBack}},[e._v("返回")])])]),2==e.deviceId?a("div",[a("device-smoke")],1):5==e.deviceId||21==e.deviceId||22==e.deviceId||23==e.deviceId||7==e.deviceId||26==e.deviceId||15==e.deviceId?a("div",[a("device-gas")],1):24==e.deviceId?a("div",[a("device-fire-engine")],1):"video"==e.deviceId?a("div",[a("device-video")],1):"patrol"==e.deviceId?a("div",[a("device-patrol")],1):11==e.deviceId?a("div",[a("device-elestric")],1):e._e()])},n=[],r=(a("7f7f"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"device-smoke"},[a("div",{staticClass:"data"},[a("iot-table",{attrs:{tableHeader:e.tableHeader,tableData:e.tableData,pagination:e.pagination,loading:e.loading},on:{reloaddata:e.initData},scopedSlots:e._u([{key:"col-install_address",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.install_address)+"-"+e._s(t.row.building)+"-"+e._s(t.row.floor)+"-"+e._s(t.row.room))])])}},{key:"col-job_state",fn:function(t){return a("div",{},[a("p",[e._v(e._s(0===t.row.job_state?"在线":"离线"))])])}},{key:"col-alarm_state",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.alarm_state?"已报警":"正常"))])])}},{key:"col-user_name",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.user_name||t.row.user_account))])])}},{key:"col-confirm",fn:function(t){return a("div",{},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleClick(t.row)}}},[e._v("隐患通知单")])],1)}}])})],1)])}),o=[],s=(a("ac6a"),a("96cf"),a("3b8d")),c=a("aa98"),l=a("3389"),u=a("5568"),p={name:"DeviceSmoke",components:{iotTable:u["a"]},data:function(){return{loading:!1,queryFilter:{mac:"",building:"",floor:"",room:"",wise_type:"ALL"},tableData:[],pagination:{page:1,per_page:10,total:0},tableHeader:[{prop:"install_address",label:"安装位置",type:"slot"},{prop:"last_time",label:"最后在线时间"},{prop:"battery",label:"剩余电量%"},{prop:"job_state",label:"设备状态",type:"slot"},{prop:"alarm_state",label:"报警状态",type:"slot"},{prop:"user_name",label:"监管人及电话",type:"slot"},{prop:"mac",label:"设备mac"},{prop:"confirm",label:"操作",type:"slot"}]}},computed:{activeSite:function(){return this.$store.state.place.checkItem}},mounted:function(){this.activeSite.place.id&&this.initData()},methods:{initData:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,i,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,t={page:this.pagination.page,per_page:this.pagination.per_page,type:this.$route.params.type,mac:this.queryFilter.mac?this.queryFilter.mac:void 0,building:this.queryFilter.building?this.queryFilter.building:void 0,floor:this.queryFilter.floor?this.queryFilter.floor:void 0,room:this.queryFilter.room?this.queryFilter.room:void 0,wise_type:this.queryFilter.wise_type},e.prev=2,e.next=5,Object(c["s"])(this.$store.state.place.checkItem.place.id||this.$route.query.placeid,t);case 5:a=e.sent,i=a.data,i.page_info.total>0?(i.items.forEach(function(e){e.install_address=n.activeSite.place.name}),this.noDevices=!1):this.noDevices=!0,this.tableData=i.items,this.pagination={total:i.page_info.total,page:i.page_info.page,per_page:i.page_info.per_page},e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](2),l["a"].error("加载项目数据失败",l["a"].findErrorMsg(e.t0));case 15:this.loading=!1;case 16:case"end":return e.stop()}},e,this,[[2,12]])}));function t(){return e.apply(this,arguments)}return t}()}},d=p,f=(a("f91c"),a("2877")),v=Object(f["a"])(d,r,o,!1,null,"703f63f7",null),m=v.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"device-smoke"},[a("div",{staticClass:"data"},[a("iot-table",{attrs:{tableHeader:e.tableHeader,tableData:e.tableData,pagination:e.pagination,loading:e.loading},on:{reloaddata:e.initData},scopedSlots:e._u([{key:"col-install_address",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.install_address)+"-"+e._s(t.row.building)+"-"+e._s(t.row.floor)+"-"+e._s(t.row.room))])])}},{key:"col-job_state",fn:function(t){return a("div",{},[a("p",[e._v(e._s(0===t.row.job_state?"在线":"离线"))])])}},{key:"col-alarm_state",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.alarm_state?"已报警":"正常"))])])}},{key:"col-user_name",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.user_name)+" | "+e._s(t.row.user_account))])])}},{key:"col-mac",fn:function(t){return a("div",{},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDetails(t.row)}}},[e._v(e._s(t.row.mac))])],1)}},{key:"col-confirm",fn:function(t){return a("div",{},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleMap(t.row)}}},[a("span",{staticClass:"iconfont iconditu"})]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDelete(t.row)}}},[a("span",{staticClass:"iconfont iconshanchu"})])],1)}}])})],1),a("map-mark",{ref:"mapMark",on:{"point-change":e.saveLocation}})],1)},_=[],g=(a("6b54"),function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"popup yh-detail map_mark"},[a("div",{attrs:{id:e.mapId}}),a("span",{staticClass:"layui-layer-setwin",attrs:{id:"btn-close"}},[a("a",{staticClass:"close-popup layui-layer-close layui-layer-close1",attrs:{href:"javascript:;"},on:{click:e.cancel}},[a("span",{staticClass:"iconfont iconguanbi closeicon"})])])])}),y=[],b={data:function(){return{mapId:"map_".concat(Date.now()),map:void 0,position:{lng:116,lat:40},position_new:{lng:116,lat:40},obj:void 0}},methods:{show:function(e,t,a){var i=this;this.obj=a,this.map.clearOverlays(),this.$el.style.top="0px",this.position.lat=t-0,this.position.lng=e-0,this.position_new.lng=this.position.lng,this.position_new.lat=this.position.lat,this.showStatus=!0;var n=new BMap.Point(this.position.lng,this.position.lat);this.map.centerAndZoom(new BMap.Point(this.position.lng,this.position.lat),19),this.map.enableScrollWheelZoom(!0);var r=new BMap.Icon("./static/img/icon1.png",new BMap.Size(25,25)),o=new BMap.Marker(n,{icon:r});o.enableDragging(),o.addEventListener("dragend",function(e){i.position_new.lng=e.point.lng,i.position_new.lat=e.point.lat}),this.map.addOverlay(o)},cancel:function(){var e=this;!this.obj||this.position.lat===this.position_new.lat&&this.position.lng===this.position_new.lng||l["a"].confirm("定位发生改变","是否保存更新定位信息",function(){e.$emit("point-change",{obj:e.obj,lng:e.position_new.lng,lat:e.position_new.lat})}),this.$el.style.top="-99999px"}},mounted:function(){this.map=new BMap.Map(document.getElementById(this.mapId),{enableMapClick:!0,mapType:BMAP_HYBRID_MAP}),this.map.addControl(new BMap.MapTypeControl({mapTypes:[BMAP_NORMAL_MAP,BMAP_HYBRID_MAP]}))}},w=b,k=(a("4360c"),Object(f["a"])(w,g,y,!1,null,null,null)),C=k.exports,x={name:"DeviceSmoke",components:{mapMark:C,iotTable:u["a"]},data:function(){return{loading:!0,queryFilter:{mac:"",building:"",floor:"",room:"",wise_type:"ALL"},tableData:[],pagination:{page:1,per_page:10,total:0},tableHeader:[{prop:"install_address",label:"安装位置",width:300,type:"slot"},{prop:"last_time",label:"最后在线时间"},{prop:"job_state",label:"设备状态",type:"slot"},{prop:"alarm_state",label:"报警状态",type:"slot"},{prop:"user_name",label:"监管人及电话",width:300,type:"slot"},{prop:"mac",label:"设备mac",type:"slot"},{prop:"confirm",label:"操作",type:"slot"}]}},computed:{activeSite:function(){return this.$store.state.place.checkItem}},mounted:function(){this.activeSite.place.id&&this.initData()},methods:{initData:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,i,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,t={page:this.pagination.page,per_page:this.pagination.per_page,type:this.$route.params.type,mac:this.queryFilter.mac?this.queryFilter.mac:void 0,building:this.queryFilter.building?this.queryFilter.building:void 0,floor:this.queryFilter.floor?this.queryFilter.floor:void 0,room:this.queryFilter.room?this.queryFilter.room:void 0,wise_type:this.queryFilter.wise_type},e.prev=2,e.next=5,Object(c["s"])(this.$store.state.place.checkItem.place.id||this.$route.query.placeid,t);case 5:a=e.sent,i=a.data,i.page_info.total>0?(i.items.forEach(function(e){e.install_address=n.activeSite.place.name}),this.noDevices=!1):this.noDevices=!0,this.tableData=i.items,this.pagination={total:i.page_info.total,page:i.page_info.page,per_page:i.page_info.per_page},e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](2),l["a"].error("加载项目数据失败",l["a"].findErrorMsg(e.t0));case 15:this.loading=!1;case 16:case"end":return e.stop()}},e,this,[[2,12]])}));function t(){return e.apply(this,arguments)}return t}(),handleMap:function(e){this.$refs.mapMark.show(e.lng,e.lat,e)},handleDelete:function(e){var t=this;l["a"].confirmdevice("确定要解绑？",e.mac,"解绑后将无法接收设备消息!",function(a){Object(c["B"])(e.mac,a).then(function(e){200===e.status?(l["a"].info("解绑成功"),t.initData()):l["a"].error("解绑失败",e.msg)},function(e){l["a"].error("解绑失败",l["a"].findErrorMsg(e))})})},handleDetails:function(e){this.$router.push({path:"/equipment/devices-list/".concat(this.$route.params.type,"/").concat(e.mac),query:{name:this.$route.query.name}})},saveLocation:function(e){var t=this;Object(c["o"])({mac:e.obj.mac,lat:e.lat.toString(),lng:e.lng.toString()}).then(function(e){t.initData(),l["a"].success("更新成功","已更新设备位置")},function(e){l["a"].error("更新失败",l["a"].findErrorMsg(e))})}}},$=x,D=(a("75c7"),Object(f["a"])($,h,_,!1,null,"15d6c9ba",null)),S=D.exports,q=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"deviceFireEngine"},[a("div",{staticClass:"lists"},e._l(e.devices,function(e,t){return a("device-fire-engine-card",{key:t,staticClass:"device-item",attrs:{"ff-device":e}})}),1),a("save-device",{ref:"saveDevice"})],1)},M=[],E=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"deviceFireEngineCard"},[a("div",{staticClass:"second-title"},[a("span",{on:{click:e.handleDet}},[e._v(e._s(e.ffDevice.mac))]),a("span",{staticClass:"iconfont iconguanlian",on:{click:function(t){return e.del(t,e.ffDevice.mac)}}})]),a("div",{staticClass:"desc-info"},[a("p",[a("span",{staticClass:"iconfont iconditu"}),a("span",{staticClass:"val"},[a("i",[e._v(e._s(e.ffDevice.brand_name))]),e._v("\n          |\n          "),a("i",[e._v(e._s(e.ffDevice.model_name))])])]),a("p",[a("span",{staticClass:"iconfont iconditu"}),a("span",{staticClass:"val"},[a("i",[e._v(e._s(e.ffDevice.address))])])]),a("p",[a("span",{staticClass:"iconfont iconditu"}),a("span",{staticClass:"val"},[a("i",[e._v(e._s(e.ffDevice.user_name))]),e._v(" | "),a("i",[e._v(e._s(e.ffDevice.user_account))]),a("i",{staticClass:"text-green"},[e._v("（共"+e._s(e.ffDevice.supervisor_count)+"人）")])])])]),a("div",{staticClass:"event-info"},[a("p",{staticClass:"t",on:{click:function(t){return t.stopPropagation(),e.handleShow(t)}}},[e._v("事件信息")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.isActive,expression:"isActive"}],staticClass:"con"})])])},j=[],A=a("24b9"),F={name:"DeviceFireEngineCard",created:function(){document.addEventListener("click",this.handleHide)},props:{ffDevice:{required:!0}},data:function(){return{isActive:!1,alarms:[]}},methods:{handleShow:function(){this.isActive=!this.isActive,this.loadAlarms()},handleHide:function(){this.isActive=!1},handleDet:function(){this.$router.push({path:"/equipment/devices-list/".concat(this.$route.params.type,"/").concat(this.ffDevice.mac),query:{name:this.$route.query.name}})},loadAlarms:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={page:1,per_page:100,start:~~((new Date).getTime()/1e3)-31536e3,end:~~((new Date).getTime()/1e3),pid:this.$store.state.place.checkItem.place.id,mac:this.ffDevice.mac},e.prev=1,e.next=4,Object(c["z"])(t);case 4:a=e.sent,i=a.data,this.loadAlarmsStatus=!0,this.alarms=i.items.map(function(e){return e.alarm_time=A["a"].format(new Date(1e3*e.alarm_time),"YYYY-MM-dd HH:mm:ss"),e}),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](1),l["a"].error("加载事件失败",l["a"].findErrorMsg(e.t0));case 13:case"end":return e.stop()}},e,this,[[1,10]])}));function t(){return e.apply(this,arguments)}return t}(),del:function(e,t){var a=this;e.stopPropagation(),l["a"].confirm("确定要删除消防主机联网？","",function(){Object(c["A"])(t).then(function(e){l["a"].success("删除成功"),a.$parent.queryDevices()},function(e){l["a"].error("删除失败",l["a"].findErrorMsg(e))})})}}},N=F,T=(a("e742"),Object(f["a"])(N,E,j,!1,null,"ee3033f4",null)),O=T.exports,I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.showStatus,expression:"showStatus"}],staticClass:"popup popup-add",attrs:{id:"save-ff"}},[a("div",{staticClass:"pop-content"},[a("p",{staticClass:"popup-title"},[e._v("\n        添加主机联网设备\n      ")]),a("div",{staticClass:"popup-con"},[a("ul",{staticClass:"row"},[a("li",{staticClass:"col-lg-6",class:{warning:e.$v.deviceType.$dirty&&e.$v.deviceType.$invalid}},[e._m(0)]),e.isSType?a("li",{staticClass:"col-lg-6",class:{warning:e.$v.info.brandNum.$dirty&&e.$v.info.brandNum.$invalid}},[e._m(1)]):e._e(),e.isSType?a("li",{staticClass:"col-lg-6",class:{warning:e.$v.info.brandNum.$dirty&&e.$v.info.brandNum.$invalid}},[e._m(2)]):e._e(),e.isMType?a("li",{staticClass:" col-lg-6",class:{warning:e.$v.info.userAccount.$dirty&&e.$v.info.userAccount.$invalid}},[e._m(3),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.userAccount,expression:"info.userAccount"}],attrs:{type:"text",placeholder:"请输入设备账号"},domProps:{value:e.info.userAccount},on:{input:[function(t){t.target.composing||e.$set(e.info,"userAccount",t.target.value)},e.$v.info.userAccount.$touch]}})]):e._e(),e.isMType?a("li",{staticClass:" col-lg-6",class:{warning:e.$v.info.password.$dirty&&e.$v.info.password.$invalid}},[e._m(4),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.password,expression:"info.password"}],attrs:{type:"text",placeholder:"请输入设备密码"},domProps:{value:e.info.password},on:{input:[function(t){t.target.composing||e.$set(e.info,"password",t.target.value)},e.$v.info.password.$touch]}})]):e._e(),a("li",{staticClass:"col-lg-6",class:{warning:e.$v.info.mac.$dirty&&e.$v.info.mac.$invalid}},[e._m(5),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.mac,expression:"info.mac"}],attrs:{type:"text",placeholder:"请输入设备设备MAC"},domProps:{value:e.info.mac},on:{input:[function(t){t.target.composing||e.$set(e.info,"mac",t.target.value)},e.$v.info.mac.$touch]}})]),a("li",{staticClass:"col-lg-6"},[e._m(6),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.building,expression:"info.building"}],attrs:{type:"text",placeholder:"请输入楼栋"},domProps:{value:e.info.building},on:{input:function(t){t.target.composing||e.$set(e.info,"building",t.target.value)}}})]),a("li",{staticClass:"col-lg-6"},[e._m(7),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.floor,expression:"info.floor"}],attrs:{type:"text",placeholder:"请输入楼层"},domProps:{value:e.info.floor},on:{input:function(t){t.target.composing||e.$set(e.info,"floor",t.target.value)}}})]),a("li",{staticClass:"col-lg-6"},[e._m(8),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.room,expression:"info.room"}],attrs:{type:"text",placeholder:"请输入房间号"},domProps:{value:e.info.room},on:{input:function(t){t.target.composing||e.$set(e.info,"room",t.target.value)}}})]),a("li",{staticClass:" col-lg-6",class:{warning:e.$v.info.position.$dirty&&e.$v.info.position.$invalid}},[e._m(9),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.position,expression:"info.position"}],attrs:{type:"text",placeholder:"请输入该设备所在场所坐标"},domProps:{value:e.info.position},on:{input:[function(t){t.target.composing||e.$set(e.info,"position",t.target.value)},e.$v.info.position.$touch]}}),e._m(10)]),a("li",{staticClass:"col-lg-12",class:{warning:e.$v.supervisors.$dirty&&e.$v.supervisors.$invalid}},[e._m(11),a("div",{staticClass:"multiselect"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.supervisorsName,expression:"supervisorsName"}],attrs:{type:"text",readonly:"readonly",placeholder:"请选择设备监管人，可多选"},domProps:{value:e.supervisorsName},on:{click:function(t){return e.showSuperVisorList(t)},input:function(t){t.target.composing||(e.supervisorsName=t.target.value)}}}),a("i",{staticClass:"xsj"}),a("div",{staticClass:"dropdown"},[a("ul",e._l(e.allSupervisors,function(t){return a("li",{key:t.id,class:{checked:t.flag},on:{click:function(a){return e.chooseUser(t)}}},[e._v("\n                    "+e._s(t.name)+"\n                  ")])}),0)])])]),a("li",{staticClass:"cl text-center"},[a("button",{staticClass:"btn btn-middle cancel",on:{click:function(t){e.showStatus=!e.showStatus}}},[e._v("取消")]),a("button",{staticClass:"btn btn-middle yes",on:{click:e.submit}},[e._v("添加")])])])]),a("span",{staticClass:"layui-layer-setwin"},[a("a",{staticClass:"close-popup layui-layer-close layui-layer-close1",attrs:{href:"javascript:;"},on:{click:function(t){e.showStatus=!e.showStatus}}})])])])},H=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              设备类型\n              "),a("small",{staticClass:"fr"},[e._v("*请选择设备类型")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              厂商\n              "),a("small",{staticClass:"fr"},[e._v("*请选择厂商")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              型号\n              "),a("small",{staticClass:"fr"},[e._v("*请选择型号")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              设备账号\n              "),a("small",{staticClass:"fr"},[e._v("*请输入设备账号")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              设备密码\n              "),a("small",{staticClass:"fr"},[e._v("*请输入设备密码")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              MAC\n              "),a("small",{staticClass:"fr"},[e._v("*请输入设备MAC")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              楼栋\n              "),a("small",{staticClass:"fr"},[e._v("*请输入设备MAC/IMEI")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              楼层\n              "),a("small",{staticClass:"fr"},[e._v("*请输入楼层")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              房间号\n              "),a("small",{staticClass:"fr"},[e._v("*请输入房间号")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              场所坐标\n              "),a("small",{staticClass:"fr"},[e._v("*请输入该设备所在场所坐标")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"tips"},[e._v("点击 "),a("a",{attrs:{href:"http://api.map.baidu.com/lbsapi/getpoint/index.html",target:"_blank"}},[e._v("这里")]),e._v(" 查看如何获取坐标")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              监管人\n              "),a("small",{staticClass:"fr"},[e._v("*请选择设备监管人")])])}],B=(a("456d"),a("28a5"),a("78ef")),P=a("b5ae"),U={data:function(){return{showStatus:!1,brands:[],models:[],deviceType:void 0,isSType:!1,isMType:!1,deviceTypes:[{name:"S型",code:0},{name:"M型",code:1}],info:{mac:"",userAccount:"",password:"",building:"",floor:"",room:"",brandNum:"",brandName:"",modelNum:"",position:""},supervisorsName:"",supervisors:[]}},validations:{info:{mac:{required:P["required"],format:Object(B["withParams"])({type:"format"},function(e){return e&&/^[a-zA-Z0-9]{12}$/.test(e)})},userAccount:{required:P["required"]},password:{required:P["required"]},brandNum:{required:P["required"]},modelNum:{required:P["required"]},position:{required:P["required"],format:Object(B["withParams"])({type:"format"},function(e){var t=e.split(",");if(2!==t.length)return!1;var a=+t[0],i=+t[1];return a>=-180&&a<=180&&i>=-90&&i<=90})}},deviceType:{required:P["required"]},supervisors:{required:P["required"]}},computed:{placeItem:function(){return this.$store.state.place.checkItem},allSupervisors:function(){return console.log(this.placeItem),this.placeItem.supervisors.map(function(e){return{name:e.name,duty:e.duty,id:e.id,phone:e.phone,flag:!1}})}},watch:{"info.brandNum":function(e){e&&e.models&&(this.models=e.models,this.info.modelNum="")},deviceType:function(e){e&&(this.isMType=1===e.code,this.isSType=!this.isMType,this.isMType?(this.info.userAccount="",this.info.password="",this.info.brandNum={code:0},this.info.modelNum={code:0}):(this.info.userAccount="default",this.info.password="default",this.info.brandNum="",this.info.modelNum=""))}},methods:{reset:function(){this.supervisorsName="",this.supervisors=[],this.brands=this.brands.slice(),this.models=[],this.allSupervisors.forEach(function(e){e.flag=!1}),this.info={mac:"",userAccount:"",password:"",building:"",floor:"",room:"",brandNum:"",brandName:"",modelNum:"",position:""},this.deviceTypes=this.deviceTypes.slice(),this.deviceType=void 0,this.$v.info.mac.$reset(),this.$v.info.userAccount.$reset(),this.$v.info.password.$reset(),this.$v.info.brandNum.$reset(),this.$v.info.modelNum.$reset(),this.$v.info.position.$reset(),this.$v.deviceType.$reset(),this.$v.supervisors.$reset()},show:function(){this.reset(),this.showStatus=!0,this.$el.style.zIndex=Date.now()%1e8},close:function(){this.showStatus=!1},showSuperVisorList:function(e){},queryBrands:function(){var e=this;Object(c["j"])().then(function(t){var a=Object.keys(t.data).map(function(e){return{name:t.data[e].name,code:+e,models:t.data[e].models.map(function(e){return Object.keys(e).map(function(t){return{code:+t,name:e[t]}})[0]})}});e.brands=a}).catch(function(e){l["a"].error("加载厂商数据失败",l["a"].findErrorMsg(e))})},chooseUser:function(e){e.flag=!e.flag,this.supervisors=this.allSupervisors.filter(function(e){return e.flag}),this.supervisorsName=this.supervisors.map(function(e){return e.name}).join(",")},validateAll:function(){this.$v.info.mac.$touch(),this.$v.info.userAccount.$touch(),this.$v.info.password.$touch(),this.$v.info.brandNum.$touch(),this.$v.info.modelNum.$touch(),this.$v.info.position.$touch(),this.$v.deviceType.$touch(),this.$v.supervisors.$touch()},submit:function(){if(this.validateAll(),!this.$v.info.$invalid&&!this.$v.supervisors.$invalid){var e=this.supervisors.map(function(e){return e.phone}),t=this.info.position.split(","),a={building:this.info.building||"",room:this.info.room||"",floor:this.info.floor||"",pid:this.placeItem.place.id,type:1,number:this.info.mac,phone:e[0],supervisors:e,lat:+t[1],lng:+t[0],types:24,ffhost:{brand_num:+this.info.brandNum.code,model_num:+this.info.modelNum.code,uid:"default"===this.info.userAccount?void 0:this.info.userAccount,password:"default"===this.info.password?void 0:this.info.password}};this.postData(a)}},postData:function(e){var t=this;return deviceApi.bindDevice(e).then(function(e){l["a"].success("保存成功"),t.showStatus=!1,t.$parent.queryDevices()},function(e){l["a"].error("保存失败",l["a"].findErrorMsg(e))})}},created:function(){this.queryBrands()},components:{}},L=U,R=(a("dfde"),Object(f["a"])(L,I,H,!1,null,null,null)),z=R.exports,V={name:"DeviceFireEngine",components:{deviceFireEngineCard:O,saveDevice:z},mounted:function(){this.queryDevices()},data:function(){return{devices:[]}},computed:{activeSite:function(){return this.$store.state.place.checkItem}},watch:{"activeSite.place.id":function(e){void 0!==e&&this.queryDevices()}},methods:{queryDevices:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(c["t"])(this.activeSite.place.id);case 3:t=e.sent,a=t.data,this.devices=a,e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),l["a"].error("加载设备失败",l["a"].findErrorMsg(e.t0));case 11:case"end":return e.stop()}},e,this,[[0,8]])}));function t(){return e.apply(this,arguments)}return t}(),handleShowadd:function(){this.$refs.saveDevice.show()}}},Y=V,W=(a("ca14"),Object(f["a"])(Y,q,M,!1,null,"a998f494",null)),J=W.exports,Z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"device-smoke"},[a("p",{staticClass:"tools"},[a("span",{staticClass:"add-video",on:{click:e.handleVideoList}},[e._v("视频列表")]),a("span",{staticClass:"add-video",on:{click:e.handleAddVideo}},[e._v("添加视频")])]),a("div",{staticClass:"data"},[a("iot-table",{attrs:{tableHeader:e.tableHeader,tableData:e.tableData,pagination:e.pagination,loading:e.loading},on:{reloaddata:e.initData},scopedSlots:e._u([{key:"col-install_address",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.install_address)+"-"+e._s(t.row.building)+"-"+e._s(t.row.floor)+"-"+e._s(t.row.room))])])}},{key:"col-confirm",fn:function(t){return a("div",{},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleShowVideo(t.row)}}},[a("span",{staticClass:"iconfont iconshipin"})]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleUpdateVideo(t.row)}}},[a("span",{staticClass:"iconfont iconbianji"})]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDelete(t.row)}}},[a("span",{staticClass:"iconfont iconshanchu"})])],1)}}])})],1)])},G=[],K=(a("6762"),a("1157")),Q=a.n(K),X={name:"DeviceSmoke",components:{iotTable:u["a"]},data:function(){return{loading:!1,queryFilter:{mac:"",address:""},tableData:[],pagination:{page:1,per_page:10,total:0},tableHeader:[{prop:"install_address",label:"安装位置",type:"slot"},{prop:"mac",label:"设备mac"},{prop:"url",label:"视频流地址"},{prop:"confirm",label:"操作",type:"slot"}]}},computed:{activeSite:function(){return this.$store.state.place.checkItem}},mounted:function(){this.activeSite.place.id&&this.initData()},methods:{initData:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,i,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,t={page:this.pagination.page,per_page:this.pagination.per_page,type:23,mac:this.queryFilter.mac?this.queryFilter.mac:void 0,address:this.queryFilter.address?this.queryFilter.address:void 0},e.prev=2,e.next=5,Object(c["w"])(this.$store.state.place.checkItem.place.id||this.$route.query.placeid,t);case 5:a=e.sent,i=a.data,i.page_info.total>0?(i.items.forEach(function(e){e.install_address=n.activeSite.place.name}),this.noDevices=!1):this.noDevices=!0,this.tableData=i.items,this.pagination={total:i.page_info.total,page:i.page_info.page,per_page:i.page_info.per_page},e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](2),l["a"].error("加载项目数据失败",l["a"].findErrorMsg(e.t0));case 15:this.loading=!1;case 16:case"end":return e.stop()}},e,this,[[2,12]])}));function t(){return e.apply(this,arguments)}return t}(),handleAddVideo:function(){this.$router.push({path:"/equipment/video/add"})},handleVideoList:function(){this.$router.push({path:"/equipment/video/list"})},handleUpdateVideo:function(e){this.$router.push({path:"/equipment/video/edit",query:{mac:e.mac,id:e.id,address:e.address,url:e.url}})},handleDelete:function(e){var t=this;l["a"].confirm("确定要删除？","删除后设备无法查看视频!",function(){Object(c["c"])(e.id).then(function(e){200===e.status?(l["a"].info("删除成功"),t.initData()):l["a"].error("删除失败",e.msg)},function(e){l["a"].error("删除失败",l["a"].findErrorMsg(e))})})},handleShowVideo:function(e){var t,a,i,n=e.url.split("/");t=n[0],a=n[1]?1*e.url.split("/")[1]-1:0,i=n[2]&&"main"!=n[2]?1:0;var r={devId:t,chnl:a+"",streamType:i+""};Object(c["k"])(r).then(function(e){var t=e.code,a={"-4401":"盒子不通","-4402":"盒子下的设备不通","-4403":"登录盒子下的设备的用户名密码不匹配","-4404":"监听设备连接超时","-4405":"接收设备数据超时","-4406":"错误的设备数据格式","-4407":"此通道不存在"};if(0==t){var i=e.datas.hlsUrl,n=document.getElementById("vlc_player");if(Q()("#videoFrameBox").show(),n.playlist){n.playlist.items.clear(),document.getElementById("vlc_player_container").style.top="0";var r=n.playlist.add(i);n.playlist.playItem(r)}else{l["a"].error("未检测到vlc插件，正在切换网络播放模式");var o=Q()("#videoFrame");o.show(),0==Q()("#myVideo").length&&Q()("#videoFrame").append("<video id='myVideo' class='video-js vjs-default-skin  vjs-big-play-centered' controls preload='none' data-setup='{}' width='1200px' height='500px' ></video>");var s=videojs("myVideo");s.src({src:i,type:"application/x-mpegURL"}),s.load(),s.play(),window.onbeforeunload=function(){null!=s&&s.dispose()}}}else{var c=[-3301,-3302,-3303,-3304,-3305,-3306,-3307,-3308,-3309,-3310,-3311,-3312,-3313],u=c.includes(t);if(u)return void l["a"].error(t+"：服务器内部错误");if(a[t])return void l["a"].error(t+"："+a[t]);l["a"].error(t+"：未知错误")}})}}},ee=X,te=(a("0ec8"),Object(f["a"])(ee,Z,G,!1,null,"4d4f0c50",null)),ae=te.exports,ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"devicePatrol"},[e._m(0),a("device-patrol1"),e._m(1),a("device-patrol2")],1)},ne=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"devicetype"},[a("p",{staticClass:"t"},[e._v("设备列表")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"devicetype"},[a("p",{staticClass:"t"},[e._v("巡检列表")])])}],re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"device-smoke"},[a("div",{staticClass:"data"},[a("iot-table",{attrs:{tableHeader:e.tableHeader,tableData:e.tableData,pagination:e.pagination,loading:e.loading},on:{reloaddata:e.initData},scopedSlots:e._u([{key:"col-province",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.province)+"/"+e._s(t.row.city)+"/"+e._s(t.row.county))])])}},{key:"col-last_time",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.last_time?e.calcTime(t.row.last_time):""))])])}},{key:"col-expire_date",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.expire_date?e.calcTime(t.row.expire_date):""))])])}},{key:"col-confirm",fn:function(t){return a("div",{},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleMap(t.row)}}},[a("span",{staticClass:"iconfont iconditu"})]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDelete(t.row)}}},[a("span",{staticClass:"iconfont iconshanchu"})])],1)}}])})],1),a("map-mark",{ref:"mapMark",on:{"point-change":e.saveLocation}})],1)},oe=[],se={name:"DeviceSmoke",components:{mapMark:C,iotTable:u["a"]},data:function(){return{loading:!1,queryFilter:{mac:"",building:"",floor:"",room:"",wise_type:"ALL"},tableData:[],pagination:{page:1,per_page:10,total:0},tableHeader:[{prop:"province",label:"省/市、区",type:"slot"},{prop:"street",label:"详细地址"},{prop:"last_user_name",label:"最近巡检人"},{prop:"last_user_phone",label:"联系电话"},{prop:"mac",label:"设备mac"},{prop:"last_time",label:"最近巡检时间",type:"slot"},{prop:"expire_date",label:"有效期至",type:"slot"},{prop:"confirm",label:"操作",type:"slot"}]}},computed:{activeSite:function(){return this.$store.state.place.checkItem},calcTime:function(){return function(e){return A["a"].format(new Date(1e3*e),"YYYY-MM-dd HH:mm:ss")}}},mounted:function(){this.activeSite.place.id&&this.initData()},methods:{initData:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,i,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,t={page:this.pagination.page,per_page:this.pagination.per_page},e.prev=2,e.next=5,Object(c["u"])(this.$store.state.place.checkItem.place.id||this.$route.query.placeid,t);case 5:a=e.sent,i=a.data,i.page_info.total>0?(i.items.forEach(function(e){e.install_address=n.activeSite.place.name}),this.noDevices=!1):this.noDevices=!0,this.tableData=i.items,this.pagination={total:i.page_info.total,page:i.page_info.page,per_page:i.page_info.per_page},e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](2),l["a"].error("加载项目数据失败",l["a"].findErrorMsg(e.t0));case 15:this.loading=!1;case 16:case"end":return e.stop()}},e,this,[[2,12]])}));function t(){return e.apply(this,arguments)}return t}(),handleMap:function(e){this.$refs.mapMark.show(e.lng,e.lat,e)},handleDelete:function(e){var t=this;l["a"].confirmdevice("确定要解绑？",e.mac,"解绑后将无法接收设备消息!",function(a){Object(c["B"])(e.mac,a).then(function(e){200===e.status?(l["a"].info("解绑成功"),t.initData()):l["a"].error("解绑失败",e.msg)},function(e){l["a"].error("解绑失败",l["a"].findErrorMsg(e))})})},handleDetails:function(e){this.$router.push({path:"/equipment/devices-list/".concat(this.$route.params.type,"/").concat(e.mac)})}}},ce=se,le=(a("93a4"),Object(f["a"])(ce,re,oe,!1,null,"51e787f4",null)),ue=le.exports,pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"device-smoke"},[a("div",{staticClass:"data"},[a("iot-table",{attrs:{tableHeader:e.tableHeader,tableData:e.tableData,pagination:e.pagination,loading:e.loading},on:{reloaddata:e.initData},scopedSlots:e._u([{key:"col-province",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.province)+"/"+e._s(t.row.city)+"/"+e._s(t.row.county))])])}},{key:"col-name",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.name)+"  "+e._s(t.row.phone))])])}},{key:"col-create_time",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.create_time?e.calcTime(t.row.create_time):""))])])}},{key:"col-confirm",fn:function(t){return a("div",{},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleMap(t.row)}}},[a("span",{staticClass:"iconfont iconditu"})]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDelete(t.row)}}},[a("span",{staticClass:"iconfont iconshanchu"})])],1)}}])})],1),a("map-mark",{ref:"mapMark",on:{"point-change":e.saveLocation}})],1)},de=[],fe={name:"DeviceSmoke",components:{mapMark:C,iotTable:u["a"]},data:function(){return{loading:!0,queryFilter:{start:"",end:""},tableData:[],pagination:{page:1,per_page:10,total:0},tableHeader:[{prop:"province",label:"省/市、区",type:"slot"},{prop:"address",label:"巡检地址"},{prop:"name",label:"巡检人"},{prop:"mac",label:"设备mac"},{prop:"create_time",label:"巡检时间",type:"slot"},{prop:"confirm",label:"操作",type:"slot"}]}},computed:{activeSite:function(){return this.$store.state.place.checkItem},calcTime:function(){return function(e){return A["a"].format(new Date(1e3*e),"YYYY-MM-dd HH:mm:ss")}}},mounted:function(){this.activeSite.place.id&&this.initData()},methods:{initData:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,i,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,t={page:this.pagination.page,per_page:this.pagination.per_page,start:Math.ceil(this.queryFilter.start/1e3),end:Math.ceil(this.queryFilter.end/1e3),pid:this.activeSite.place.id},e.prev=2,e.next=5,Object(c["v"])(this.$store.state.place.checkItem.place.id||this.$route.query.placeid,t);case 5:a=e.sent,i=a.data,i.page_info.total>0?(i.items.forEach(function(e){e.install_address=n.activeSite.place.name}),this.noDevices=!1):this.noDevices=!0,this.tableData=i.items,this.pagination={total:i.page_info.total,page:i.page_info.page,per_page:i.page_info.per_page},e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](2),l["a"].error("加载项目数据失败",l["a"].findErrorMsg(e.t0));case 15:this.loading=!1;case 16:case"end":return e.stop()}},e,this,[[2,12]])}));function t(){return e.apply(this,arguments)}return t}(),handleMap:function(e){this.$refs.mapMark.show(e.lng,e.lat,e)},handleDelete:function(e){var t=this;l["a"].confirmdevice("确定要解绑？",e.mac,"解绑后将无法接收设备消息!",function(a){Object(c["B"])(e.mac,a).then(function(e){200===e.status?(l["a"].info("解绑成功"),t.initData()):l["a"].error("解绑失败",e.msg)},function(e){l["a"].error("解绑失败",l["a"].findErrorMsg(e))})})},handleDetails:function(e){this.$router.push({path:"/equipment/devices-list/".concat(this.$route.params.type,"/").concat(e.mac)})}}},ve=fe,me=(a("943d"),Object(f["a"])(ve,pe,de,!1,null,"623009e7",null)),he=me.exports,_e={name:"DevicePatrol",components:{devicePatrol1:ue,devicePatrol2:he},data:function(){return{}}},ge=_e,ye=(a("ae1e"),Object(f["a"])(ge,ie,ne,!1,null,"1bd0f008",null)),be=ye.exports,we=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"deviceFireEngine"},[a("div",{staticClass:"select-tab"},[a("span",{staticClass:"iconfont iconfenlei",class:{active:1===e.status},on:{click:function(t){return e.setStatus(1)}}}),a("span",{staticClass:"iconfont iconfenlei1",class:{active:2===e.status},on:{click:function(t){return e.setStatus(2)}}}),a("span",{staticClass:"iconfont iconbianji",class:{active:3===e.status},on:{click:function(t){return e.setStatus(3)}}})]),1===e.status?a("div",{staticClass:"con"},[a("iot-table",{attrs:{tableHeader:e.tableHeader,tableData:e.tableData,pagination:e.pagination,loading:e.loading},on:{reloaddata:e.queryDeviceslist},scopedSlots:e._u([{key:"col-province",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.province)+e._s(t.row.city)+e._s(t.row.county)+e._s(t.row.street))])])}},{key:"col-electrovalency",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.electrovalency)+"元")])])}},{key:"col-activepower_totle",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.activepower_totle)+"W")])])}},{key:"col-energy_total",fn:function(t){return a("div",{},[a("p",[e._v(e._s(t.row.energy_total)+"KW·h")])])}}],null,!1,1644067407)})],1):e._e(),2===e.status?a("div",{staticClass:"con lists"},[e._l(e.devices,function(e,t){return a("device-elestric-card",{key:t,staticClass:"device-item",attrs:{device:e}})}),a("div",{staticClass:"device-item add",on:{click:e.showAdd}},[a("span",{staticClass:"iconfont iconjia"})])],2):e._e(),3===e.status?a("div",{staticClass:"con"},[a("div",{staticClass:"select-type"},[a("div",{staticClass:"sel"},[a("div",{staticClass:"item",class:{active:1===e.reporttype},on:{click:function(t){return e.setreporttype(1)}}},[a("span",{staticClass:"cir"}),a("span",{staticClass:"text"},[e._v("项目统计表")])]),a("div",{staticClass:"item",class:{active:2===e.reporttype},on:{click:function(t){return e.setreporttype(2)}}},[a("span",{staticClass:"cir"}),a("span",{staticClass:"text"},[e._v("电量统计表")])])]),a("div",{staticClass:"btns"},[a("el-button",{staticClass:"green",attrs:{type:"primary"},on:{click:e.lookday}},[e._v("查看日报表")]),a("el-button",{staticClass:"green",attrs:{type:"primary"},on:{click:e.lookmonth}},[e._v("查看月报表")]),a("el-button",{staticClass:"green",attrs:{type:"primary"},on:{click:e.lookyear}},[e._v("查看年报表")])],1)]),1===e.reporttype?a("div",{staticClass:"table t1"},[a("iot-table",{attrs:{tableHeader:e.tableHeader1,tableData:e.tableData1,pagination:e.pagination1,loading:e.loading,hidepagination:!0},on:{reloaddata:e.getreportform},scopedSlots:e._u([{key:"col-room",fn:function(t){return a("div",{},[t.row.room?a("p",[e._v(e._s(t.row.room))]):a("p",[e._v("无")])])}},{key:"col-mac",fn:function(t){return a("div",{},[t.row.mac?a("p",[e._v(e._s(t.row.mac))]):a("p",[e._v("无")])])}},{key:"col-energy_data_active",fn:function(t){return a("div",{},[t.row.energy_data_active?a("p",[e._v(e._s(t.row.energy_data_active))]):a("p",[e._v("无")])])}},{key:"col-energy_data_reactive",fn:function(t){return a("div",{},[t.row.energy_data_reactive?a("p",[e._v(e._s(t.row.energy_data_reactive))]):a("p",[e._v("无")])])}},{key:"col-max_electric_a",fn:function(t){return a("div",{},[t.row.max_electric_a?a("p",[e._v(e._s(t.row.max_electric_a))]):a("p",[e._v("无")])])}},{key:"col-min_electric_a",fn:function(t){return a("div",{},[t.row.min_electric_a?a("p",[e._v(e._s(t.row.min_electric_a))]):a("p",[e._v("无")])])}},{key:"col-average_electric_a",fn:function(t){return a("div",{},[t.row.average_electric_a?a("p",[e._v(e._s(t.row.average_electric_a))]):a("p",[e._v("无")])])}},{key:"col-max_electric_b",fn:function(t){return a("div",{},[t.row.max_electric_b?a("p",[e._v(e._s(t.row.max_electric_b))]):a("p",[e._v("无")])])}},{key:"col-min_electric_b",fn:function(t){return a("div",{},[t.row.min_electric_b?a("p",[e._v(e._s(t.row.min_electric_b))]):a("p",[e._v("无")])])}},{key:"col-average_electric_b",fn:function(t){return a("div",{},[t.row.average_electric_b?a("p",[e._v(e._s(t.row.average_electric_b))]):a("p",[e._v("无")])])}},{key:"col-max_electric_c",fn:function(t){return a("div",{},[t.row.max_electric_c?a("p",[e._v(e._s(t.row.max_electric_c))]):a("p",[e._v("无")])])}},{key:"col-min_electric_c",fn:function(t){return a("div",{},[t.row.min_electric_c?a("p",[e._v(e._s(t.row.min_electric_c))]):a("p",[e._v("无")])])}},{key:"col-average_electric_c",fn:function(t){return a("div",{},[t.row.average_electric_c?a("p",[e._v(e._s(t.row.average_electric_c))]):a("p",[e._v("无")])])}},{key:"col-first_time",fn:function(t){return a("div",{},[t.row.first_time?a("p",[e._v(e._s(t.row.first_time))]):a("p",[e._v("无")])])}},{key:"col-last_time",fn:function(t){return a("div",{},[t.row.last_time?a("p",[e._v(e._s(t.row.last_time))]):a("p",[e._v("无")])])}}],null,!1,2795698654)})],1):e._e(),2===e.reporttype?a("div",{staticClass:"table t2"},[a("iot-table",{attrs:{tableHeader:e.tableHeader2,tableData:e.tableData2,pagination:e.pagination2,loading:e.loading,hidepagination:!0},on:{reloaddata:e.getreportform},scopedSlots:e._u([{key:"col-room",fn:function(t){return a("div",{},[t.row.room?a("p",[e._v(e._s(t.row.room))]):a("p",[e._v("无")])])}},{key:"col-energy_data",fn:function(t){return a("div",{},[t.row.energy_data?a("p",[e._v(e._s(t.row.energy_data))]):a("p",[e._v("无")])])}},{key:"col-first_time",fn:function(t){return a("div",{},[t.row.first_time?a("p",[e._v(e._s(t.row.first_time))]):a("p",[e._v("无")])])}},{key:"col-last_time",fn:function(t){return a("div",{},[t.row.last_time?a("p",[e._v(e._s(t.row.last_time))]):a("p",[e._v("无")])])}}],null,!1,1371829803)})],1):e._e()]):e._e(),a("save-device",{ref:"saveDevice"})],1)},ke=[],Ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"deviceElestricCard"},[a("div",{staticClass:"second-title"},[e._v(e._s(e.device.mac))]),a("div",{staticClass:"info"},[a("div",{staticClass:"desc-info"},[a("div",{staticClass:"left"},[a("span",[e._v(e._s(e.device.energy_today.toFixed(2))+"度")]),a("span",[e._v(e._s(e.device.energy_today_rate.toFixed(2))+"元")])]),a("div",{staticClass:"right"},[a("elestric-echarts",{attrs:{weakdetail:e.device}})],1)]),a("div",{staticClass:"address"},[a("span",{staticClass:"iconfont iconditu"}),a("span",[e._v(e._s(e.device.province+e.device.city+e.device.county+e.device.street)+"  "+e._s(e.device.building)+"-"+e._s(e.device.floor)+"-"+e._s(e.device.room))])])])])},xe=[],$e=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.className,style:{height:e.height,width:e.width}})},De=[];a("817d");var Se=new Date,qe=(Se.getFullYear(),Se.getMonth()+1),Me=Se.getDate();qe>=1&&qe<=9&&(qe="0"+qe),Me>=0&&Me<=9&&(Me="0"+Me);var Ee={props:{weakdetail:{type:Object,required:!0},className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"100%"}},data:function(){return{chart:null,newdate:""}},mounted:function(){this.weakdetail.before_one_energy<0&&(this.weakdetail.before_one_energy=0),this.weakdetail.before_two_energy<0&&(this.weakdetail.before_two_energy=0),this.weakdetail.before_three_energy<0&&(this.weakdetail.before_three_energy=0),this.weakdetail.before_four_energy<0&&(this.weakdetail.before_four_energy=0),this.weakdetail.before_five_energy<0&&(this.weakdetail.before_five_energy=0),this.weakdetail.before_six_energy<0&&(this.weakdetail.before_six_energy=0),this.weakdetail.before_seven_energy<0&&(this.weakdetail.before_seven_energy=0),this.initChart()},beforeDestroy:function(){this.chart&&(window.removeEventListener("resize",this.__resizeHanlder),this.chart.dispose(),this.chart=null)},methods:{getDay:function(e,t){var a=new Date,i=a.getTime(),n=864e5*e;a.setTime(parseInt(i+n));var r=a.getFullYear(),o=(a.getMonth()+1).toString();o.length<=1&&(o="0"+o);var s=a.getDate().toString();return s.length<=1&&(s="0"+s),r+t+o+t+s},initChart:function(){this.chart=this.$echarts.init(this.$el,"macarons");for(var e=[1*this.weakdetail.before_seven_energy.toFixed(2),1*this.weakdetail.before_six_energy.toFixed(2),1*this.weakdetail.before_five_energy.toFixed(2),1*this.weakdetail.before_four_energy.toFixed(2),1*this.weakdetail.before_three_energy.toFixed(2),1*this.weakdetail.before_two_energy.toFixed(2),1*this.weakdetail.before_one_energy.toFixed(2)],t=e[1],a=0;a<e.length;a++)t<e[a]&&(t=e[a]);t=0==t?300:1*t+10;var i=t-this.weakdetail.before_seven_energy,n=t-this.weakdetail.before_six_energy,r=t-this.weakdetail.before_five_energy,o=t-this.weakdetail.before_four_energy,s=t-this.weakdetail.before_three_energy,c=t-this.weakdetail.before_two_energy,l=t-this.weakdetail.before_one_energy;console.log(t),console.log(e),console.log(i.toFixed(2)),console.log(n.toFixed(2)),console.log(r.toFixed(2)),console.log(o.toFixed(2)),console.log(s.toFixed(2)),console.log(c.toFixed(2)),console.log(l.toFixed(2)),this.chart.setOption({title:{},grid:{x:0,y:-5,x2:0,y2:10,borderWidth:1},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(e){return e[0].name+"<br/>"+e[0].seriesName+" : "+e[0].value}},legend:{selectedMode:!1,show:!1,data:["Acutal","Forecast"]},toolbox:{show:!1,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,xAxis:[{type:"category",data:[this.getDay(-7,"-"),this.getDay(-6,"-"),this.getDay(-5,"-"),this.getDay(-4,"-"),this.getDay(-3,"-"),this.getDay(-2,"-"),this.getDay(-1,"-")],show:!1}],yAxis:[{type:"value",boundaryGap:[0,.1],show:!1}],series:[{name:"用电量",type:"bar",barWidth:"35%",stack:"sum",barCategoryGap:"30%",itemStyle:{normal:{color:"#15a2eb",barBorderColor:"#15a2eb",barBorderWidth:2,barBorderRadius:[0,0,20,20],label:{show:!1,position:"insideTop"}}},data:[this.weakdetail.before_seven_energy.toFixed(2),this.weakdetail.before_six_energy.toFixed(2),this.weakdetail.before_five_energy.toFixed(2),this.weakdetail.before_four_energy.toFixed(2),this.weakdetail.before_three_energy.toFixed(2),this.weakdetail.before_two_energy.toFixed(2),this.weakdetail.before_one_energy.toFixed(2)]},{name:"Forecast",type:"bar",barWidth:"35%",stack:"sum",itemStyle:{normal:{color:"none",barBorderColor:"#15a2eb",barBorderWidth:2,barBorderRadius:[20,20,0,0],label:{show:!1,position:"top",formatter:function(e){for(var t=0,a=option.xAxis[0].data.length;t<a;t++)if(option.xAxis[0].data[t]==e.name)return option.series[0].data[t]+e.value},textStyle:{color:"tomato"}}}},data:[1*i.toFixed(2),1*n.toFixed(2),1*r.toFixed(2),1*o.toFixed(2),1*s.toFixed(2),1*c.toFixed(2),1*l.toFixed(2)]}]})}}},je=Ee,Ae=Object(f["a"])(je,$e,De,!1,null,null,null),Fe=Ae.exports,Ne={name:"DeviceElestricCard",props:["device"],components:{elestricEcharts:Fe},mounted:function(){console.log(this.device)},data:function(){return{}}},Te=Ne,Oe=(a("38a9"),Object(f["a"])(Te,Ce,xe,!1,null,"557bf2d2",null)),Ie=Oe.exports,He=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"show",rawName:"v-show",value:e.showStatus,expression:"showStatus"}],staticClass:"popup popup-add",attrs:{id:"save-ff"}},[a("div",{staticClass:"pop-content"},[a("p",{staticClass:"popup-title"},[e._v("\n        添加智能用电终端设备\n      ")]),a("div",{staticClass:"popup-con"},[a("ul",{staticClass:"row"},[a("li",{staticClass:"col-lg-12"},[e._m(0),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.mac,expression:"info.mac"}],attrs:{type:"text",placeholder:"请输入设备设备MAC"},domProps:{value:e.info.mac},on:{input:function(t){t.target.composing||e.$set(e.info,"mac",t.target.value)}}})]),a("li",{staticClass:"col-lg-6"},[e._m(1),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.electrovalency,expression:"info.electrovalency"}],attrs:{type:"number",min:"0",placeholder:"请输入电价"},domProps:{value:e.info.electrovalency},on:{input:function(t){t.target.composing||e.$set(e.info,"electrovalency",t.target.value)}}})]),a("li",{staticClass:"col-lg-6"},[e._m(2),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.info.current_transformer_parameters,callback:function(t){e.$set(e.info,"current_transformer_parameters",t)},expression:"info.current_transformer_parameters"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.value,value:e.value}})}),1)],1),a("li",{staticClass:"col-lg-6"},[e._m(3),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.info.current_type,callback:function(t){e.$set(e.info,"current_type",t)},expression:"info.current_type"}},e._l(e.electType,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("li",{staticClass:"col-lg-6"},[e._m(4),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.building,expression:"info.building"}],attrs:{type:"text",placeholder:"请输入楼栋"},domProps:{value:e.info.building},on:{input:function(t){t.target.composing||e.$set(e.info,"building",t.target.value)}}})]),a("li",{staticClass:"col-lg-6"},[e._m(5),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.floor,expression:"info.floor"}],attrs:{type:"text",placeholder:"请输入楼层"},domProps:{value:e.info.floor},on:{input:function(t){t.target.composing||e.$set(e.info,"floor",t.target.value)}}})]),a("li",{staticClass:"col-lg-6"},[e._m(6),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.room,expression:"info.room"}],attrs:{type:"text",placeholder:"请输入房间号"},domProps:{value:e.info.room},on:{input:function(t){t.target.composing||e.$set(e.info,"room",t.target.value)}}})]),a("li",{staticClass:" col-lg-6"},[e._m(7),a("input",{directives:[{name:"model",rawName:"v-model",value:e.info.position,expression:"info.position"}],attrs:{type:"text",placeholder:"请输入该设备所在场所坐标"},domProps:{value:e.info.position},on:{input:function(t){t.target.composing||e.$set(e.info,"position",t.target.value)}}}),e._m(8)]),a("li",{staticClass:"col-lg-12"},[e._m(9),a("div",{staticClass:"multiselect"},[a("el-select",{attrs:{placeholder:"请选择设备监管人"},model:{value:e.info.current_type,callback:function(t){e.$set(e.info,"current_type",t)},expression:"info.current_type"}},e._l(e.allSupervisors,function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}),1)],1)]),a("li",{staticClass:"cl text-center"},[a("button",{staticClass:"btn btn-middle cancel",on:{click:function(t){e.showStatus=!e.showStatus}}},[e._v("取消")]),a("button",{staticClass:"btn btn-middle yes",on:{click:e.submit}},[e._v("添加")])])])]),a("span",{staticClass:"layui-layer-setwin"},[a("a",{staticClass:"close-popup layui-layer-close layui-layer-close1",attrs:{href:"javascript:;"},on:{click:function(t){e.showStatus=!e.showStatus}}},[a("span",{staticClass:"iconfont iconguanbi"})])])])])},Be=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              MAC\n              "),a("small",{staticClass:"fr"},[e._v("*请输入设备MAC")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              电价\n              "),a("small",{staticClass:"fr"},[e._v("*请输入电价")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              互感器电流参数\n              "),a("small",{staticClass:"fr"},[e._v("*请输入设备互感器电流参数")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              电流类型\n              "),a("small",{staticClass:"fr"},[e._v("*请输入电流类型")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              楼栋\n              "),a("small",{staticClass:"fr"},[e._v("*请输入设备MAC/IMEI")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              楼层\n              "),a("small",{staticClass:"fr"},[e._v("*请输入楼层")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              房间号\n              "),a("small",{staticClass:"fr"},[e._v("*请输入房间号")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              场所坐标\n              "),a("small",{staticClass:"fr"},[e._v("*请输入该设备所在场所坐标")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticClass:"tips"},[e._v("点击 "),a("a",{attrs:{href:"http://api.map.baidu.com/lbsapi/getpoint/index.html",target:"_blank"}},[e._v("这里")]),e._v(" 查看如何获取坐标")])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("p",{staticClass:"input-title"},[e._v("\n              监管人\n              "),a("small",{staticClass:"fr"},[e._v("*请选择设备监管人")])])}],Pe={data:function(){return{showStatus:!1,brands:[],models:[],deviceType:void 0,isSType:!1,isMType:!1,deviceTypes:[{name:"S型",code:0},{name:"M型",code:1}],info:{mac:"",userAccount:"",password:"",building:"",floor:"",room:"",brandNum:"",brandName:"",modelNum:"",position:"",current_transformer_parameters:"",electrovalency:0,current_type:""},supervisorsName:"",supervisors:[],options:[{value:"5/5"},{value:"20/5"},{value:"30/5"},{value:"40/5"},{value:"50/5"},{value:"75/5"},{value:"100/5"},{value:"150/5"},{value:"200/5"},{value:"250/5"},{value:"300/5"},{value:"400/5"},{value:"500/5"},{value:"600/5"},{value:"630/5"},{value:"800/5"},{value:"1000/5"}],electType:[{label:"三相电",value:"三相"},{label:"单相电",value:"单相"}]}},validations:{info:{mac:{required:P["required"],format:Object(B["withParams"])({type:"format"},function(e){return e&&/^[a-zA-Z0-9]{12}$/.test(e)})},current_transformer_parameters:{required:P["required"]},current_type:{required:P["required"]},electrovalency:{required:P["required"]},userAccount:{required:P["required"]},password:{required:P["required"]},brandNum:{required:P["required"]},modelNum:{required:P["required"]},position:{required:P["required"],format:Object(B["withParams"])({type:"format"},function(e){var t=e.split(",");if(2!==t.length)return!1;var a=+t[0],i=+t[1];return a>=-180&&a<=180&&i>=-90&&i<=90})}},deviceType:{required:P["required"]},supervisors:{required:P["required"]}},computed:{placeItem:function(){return this.$store.state.place.checkItem},allSupervisors:function(){return this.placeItem.supervisors.map(function(e){return{name:e.name,duty:e.duty,id:e.id,phone:e.phone,flag:!1}})}},watch:{"info.brandNum":function(e){e&&e.models&&(this.models=e.models,this.info.modelNum="")},deviceType:function(e){e&&(this.isMType=1===e.code,this.isSType=!this.isMType,this.isMType?(this.info.userAccount="",this.info.password="",this.info.brandNum={code:0},this.info.modelNum={code:0}):(this.info.userAccount="default",this.info.password="default",this.info.brandNum="",this.info.modelNum=""))}},methods:{reset:function(){this.supervisorsName="",this.supervisors=[],this.brands=this.brands.slice(),this.models=[],this.allSupervisors.forEach(function(e){e.flag=!1}),this.info={mac:"",current_transformer_parameters:"",current_type:"",electrovalency:"",userAccount:"",password:"",building:"",floor:"",room:"",brandNum:"",brandName:"",modelNum:"",position:""},this.deviceTypes=this.deviceTypes.slice(),this.deviceType=void 0},show:function(){this.reset(),this.showStatus=!0,this.$el.style.zIndex=Date.now()%1e8},close:function(){this.showStatus=!1},showSuperVisorList:function(e){},queryBrands:function(){var e=this;Object(c["j"])().then(function(t){var a=Object.keys(t.data).map(function(e){return{name:t.data[e].name,code:+e,models:t.data[e].models.map(function(e){return Object.keys(e).map(function(t){return{code:+t,name:e[t]}})[0]})}});e.brands=a}).catch(function(e){l["a"].error("加载厂商数据失败",l["a"].findErrorMsg(e))})},chooseUser:function(e){e.flag=!e.flag,this.supervisors=this.allSupervisors.filter(function(e){return e.flag}),this.supervisorsName=this.supervisors.map(function(e){return e.name}).join(",")},validateAll:function(){},submit:function(){var e=this.supervisors.map(function(e){return e.phone}),t=this.info.position.split(","),a={building:this.info.building||"",room:this.info.room||"",floor:this.info.floor||"",pid:this.placeItem.place.id,number:this.info.mac,phone:e[0],supervisors:e,lat:+t[1],lng:+t[0],types:11,electricity:{current_transformer_parameters:this.info.current_transformer_parameters,electrovalency:1*this.info.electrovalency,current_type:this.info.current_type}};this.postData(a)},postData:function(e){var t=this;return Object(c["g"])(e).then(function(e){l["a"].success("保存成功"),t.showStatus=!1,t.$parent.queryDevices(),t.$parent.queryDeviceslist()},function(e){l["a"].error("保存失败",l["a"].findErrorMsg(e))})}},created:function(){this.queryBrands()},components:{}},Ue=Pe,Le=(a("53ab"),Object(f["a"])(Ue,He,Be,!1,null,null,null)),Re=Le.exports,ze={name:"DeviceFireEngine",components:{iotTable:u["a"],deviceElestricCard:Ie,saveDevice:Re},mounted:function(){this.queryDeviceslist(),this.queryDevices(),this.getreportform(),this.startTime=new Date((new Date).toLocaleDateString()).getTime()/1e3},data:function(){return{loading:!1,status:1,reporttype:1,tableData:[],tableData1:[],tableData2:[],devices:[],startTime:"",endTime:"",pagination:{page:1,per_page:10,total:0},pagination1:{page:1,per_page:10,total:0},pagination2:{page:1,per_page:10,total:0},tableHeader:[{prop:"province",label:"安装位置",type:"slot"},{prop:"electrovalency",label:"预设电价",type:"slot"},{prop:"activepower_totle",label:"有功功率",type:"slot"},{prop:"energy_total",label:"累计电能",type:"slot"},{prop:"powerfactor_totle",label:"功率因数"},{prop:"mac",label:"MAC"},{prop:"create_time",label:"监测日期"}],tableHeader1:[{prop:"room",label:"使用部门",type:"slot"},{prop:"mac",label:"表计编号",type:"slot"},{prop:"energy_data_active",label:"有功电能",type:"slot"},{prop:"energy_data_reactive",label:"无功电能",type:"slot"},{prop:"max_electric_a",label:"相电流A最高",type:"slot"},{prop:"min_electric_a",label:"相电流A最低",type:"slot"},{prop:"average_electric_a",label:"相电流A平均",type:"slot"},{prop:"max_electric_b",label:"相电流B最高",type:"slot"},{prop:"min_electric_b",label:"相电流B最低",type:"slot"},{prop:"average_electric_b",label:"相电流B平均",type:"slot"},{prop:"max_electric_c",label:"相电流C最高",type:"slot"},{prop:"min_electric_c",label:"相电流C最低",type:"slot"},{prop:"average_electric_c",label:"相电流C平均",type:"slot"},{prop:"first_time",label:"起始时间",type:"slot"},{prop:"last_time",label:"终止时间",type:"slot"}],tableHeader2:[{prop:"room",label:"使用部门",type:"slot"},{prop:"mac",label:"表计编号"},{prop:"energy_data",label:"电量值",type:"slot"},{prop:"first_time",label:"起始时间",type:"slot"},{prop:"last_time",label:"终止时间",type:"slot"}]}},computed:{activeSite:function(){return this.$store.state.place.checkItem}},methods:{setStatus:function(e){this.status=e},setreporttype:function(e){this.reporttype=e},queryDeviceslist:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,t={page:this.pagination.page,per_page:this.pagination.per_page},e.prev=2,e.next=5,Object(c["y"])(this.activeSite.place.id,t);case 5:a=e.sent,i=a.data,this.tableData=i.data,this.pagination={total:i.page_info.total,page:i.page_info.page,per_page:i.page_info.per_page},e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](2),l["a"].error("加载设备失败");case 14:this.loading=!1;case 15:case"end":return e.stop()}},e,this,[[2,11]])}));function t(){return e.apply(this,arguments)}return t}(),queryDevices:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,t={page:this.pagination.page,per_page:this.pagination.per_page},e.prev=2,e.next=5,Object(c["x"])(this.activeSite.place.id,t);case 5:a=e.sent,i=a.data,this.devices=i.data,console.log(this.devices),this.pagination={total:i.page_info.total,page:i.page_info.page,per_page:i.page_info.per_page},e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](2),l["a"].error("加载设备失败");case 15:this.loading=!1;case 16:case"end":return e.stop()}},e,this,[[2,12]])}));function t(){return e.apply(this,arguments)}return t}(),getreportform:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,i,n,r,o,s,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.loading=!0,t=new Date,t.setDate(1),t.setHours(0),t.setSeconds(0),t.setMinutes(0),a=this.startTime||parseInt(t.getTime()/1e3),1!=this.reporttype){e.next=23;break}return i={page:this.pagination2.page,per_page:this.pagination2.per_page,pid:this.activeSite.place.id,start_time:a},e.prev=9,e.next=12,Object(c["l"])(i);case 12:n=e.sent,r=n.data,this.tableData1=r,this.pagination1={total:r.page_info.total,page:r.page_info.page,per_page:r.page_info.per_page},e.next=21;break;case 18:e.prev=18,e.t0=e["catch"](9),l["a"].error("加载设备失败");case 21:e.next=37;break;case 23:if(2!=this.reporttype){e.next=37;break}return o={page:this.pagination2.page,per_page:this.pagination2.per_page,start_time:a,pid:this.activeSite.place.id},e.prev=25,e.next=28,Object(c["l"])(o);case 28:s=e.sent,u=s.data,this.tableData2=u,this.pagination2={total:u.page_info.total,page:u.page_info.page,per_page:u.page_info.per_page},e.next=37;break;case 34:e.prev=34,e.t1=e["catch"](25),l["a"].error("加载设备失败");case 37:this.loading=!1;case 38:case"end":return e.stop()}},e,this,[[9,18],[25,34]])}));function t(){return e.apply(this,arguments)}return t}(),lookday:function(){this.startTime=new Date((new Date).toLocaleDateString()).getTime()/1e3,this.getreportform()},lookmonth:function(){var e=new Date;e.setDate(1),e.setHours(0),e.setSeconds(0),e.setMinutes(0),this.startTime=parseInt(e.getTime()/1e3),this.getreportform()},lookyear:function(){var e=new Date;e.setDate(1),e.setMonth(0),e.setHours(0),e.setSeconds(0),e.setMinutes(0),this.startTime=parseInt(e.getTime()/1e3),this.getreportform()},showAdd:function(){this.$refs.saveDevice.show()}}},Ve=ze,Ye=(a("00bf"),Object(f["a"])(Ve,we,ke,!1,null,"2a82a5ad",null)),We=Ye.exports,Je={name:"Devicetype",components:{deviceSmoke:m,deviceGas:S,deviceFireEngine:J,deviceVideo:ae,devicePatrol:be,deviceElestric:We},data:function(){return{}},computed:{titleName:function(){return this.$route.query.name||"设备"},deviceId:function(){return this.$route.params.type||"2"}},methods:{handleBack:function(){this.$router.back()}}},Ze=Je,Ge=(a("4c4f"),Object(f["a"])(Ze,i,n,!1,null,"64601394",null));t["default"]=Ge.exports},"25cc":function(e,t,a){},"2e19":function(e,t,a){},3846:function(e,t,a){a("9e1e")&&"g"!=/./g.flags&&a("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:a("0bfb")})},"38a9":function(e,t,a){"use strict";var i=a("698e"),n=a.n(i);n.a},"38e0":function(e,t,a){},"4360c":function(e,t,a){"use strict";var i=a("02e8"),n=a.n(i);n.a},"473f":function(e,t,a){},"4c4f":function(e,t,a){"use strict";var i=a("70af"),n=a.n(i);n.a},"53ab":function(e,t,a){"use strict";var i=a("aff0"),n=a.n(i);n.a},"5a38":function(e,t,a){},"5a47":function(e,t,a){},6762:function(e,t,a){"use strict";var i=a("5ca1"),n=a("c366")(!0);i(i.P,"Array",{includes:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),a("9c6c")("includes")},"698e":function(e,t,a){},"6b54":function(e,t,a){"use strict";a("3846");var i=a("cb7c"),n=a("0bfb"),r=a("9e1e"),o="toString",s=/./[o],c=function(e){a("2aba")(RegExp.prototype,o,e,!0)};a("79e5")(function(){return"/a/b"!=s.call({source:"a",flags:"b"})})?c(function(){var e=i(this);return"/".concat(e.source,"/","flags"in e?e.flags:!r&&e instanceof RegExp?n.call(e):void 0)}):s.name!=o&&c(function(){return s.call(this)})},"70af":function(e,t,a){},"75c7":function(e,t,a){"use strict";var i=a("7797"),n=a.n(i);n.a},7797:function(e,t,a){},"77b1":function(e,t,a){},"817d":function(e,t,a){var i,n,r;(function(o,s){n=[t,a("313e")],i=s,r="function"===typeof i?i.apply(t,n):i,void 0===r||(e.exports=r)})(0,function(e,t){var a=function(e){"undefined"!==typeof console&&console&&console.error&&console.error(e)};if(t){var i=["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3","#e5cf0d","#97b552","#95706d","#dc69aa","#07a2a4","#9a7fd1","#588dd5","#f5994e","#c05050","#59678c","#c9ab00","#7eb00a","#6f5553","#c14089"],n={color:i,title:{textStyle:{fontWeight:"normal",color:"#008acd"}},visualMap:{itemWidth:15,color:["#5ab1ef","#e0ffff"]},toolbox:{iconStyle:{normal:{borderColor:i[0]}}},tooltip:{backgroundColor:"rgba(50,50,50,0.5)",axisPointer:{type:"line",lineStyle:{color:"#008acd"},crossStyle:{color:"#008acd"},shadowStyle:{color:"rgba(200,200,200,0.2)"}}},dataZoom:{dataBackgroundColor:"#efefff",fillerColor:"rgba(182,162,222,0.2)",handleColor:"#008acd"},grid:{borderColor:"#eee"},categoryAxis:{axisLine:{lineStyle:{color:"#008acd"}},splitLine:{lineStyle:{color:["#eee"]}}},valueAxis:{axisLine:{lineStyle:{color:"#008acd"}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.1)","rgba(200,200,200,0.1)"]}},splitLine:{lineStyle:{color:["#eee"]}}},timeline:{lineStyle:{color:"#008acd"},controlStyle:{normal:{color:"#008acd"},emphasis:{color:"#008acd"}},symbol:"emptyCircle",symbolSize:3},line:{smooth:!0,symbol:"emptyCircle",symbolSize:3},candlestick:{itemStyle:{normal:{color:"#d87a80",color0:"#2ec7c9",lineStyle:{color:"#d87a80",color0:"#2ec7c9"}}}},scatter:{symbol:"circle",symbolSize:4},map:{label:{normal:{textStyle:{color:"#d87a80"}}},itemStyle:{normal:{borderColor:"#eee",areaColor:"#ddd"},emphasis:{areaColor:"#fe994e"}}},graph:{color:i},gauge:{axisLine:{lineStyle:{color:[[.2,"#2ec7c9"],[.8,"#5ab1ef"],[1,"#d87a80"]],width:10}},axisTick:{splitNumber:10,length:15,lineStyle:{color:"auto"}},splitLine:{length:22,lineStyle:{color:"auto"}},pointer:{width:5}}};t.registerTheme("macarons",n)}else a("ECharts is not Loaded")})},"93a4":function(e,t,a){"use strict";var i=a("2e19"),n=a.n(i);n.a},"943d":function(e,t,a){"use strict";var i=a("d9f1e"),n=a.n(i);n.a},"9f96":function(e,t,a){},aa98:function(e,t,a){"use strict";a.d(t,"b",function(){return r}),a.d(t,"s",function(){return o}),a.d(t,"w",function(){return s}),a.d(t,"r",function(){return c}),a.d(t,"q",function(){return l}),a.d(t,"m",function(){return u}),a.d(t,"B",function(){return p}),a.d(t,"k",function(){return d}),a.d(t,"c",function(){return f}),a.d(t,"u",function(){return v}),a.d(t,"v",function(){return m}),a.d(t,"h",function(){return h}),a.d(t,"d",function(){return _}),a.d(t,"i",function(){return g}),a.d(t,"e",function(){return y}),a.d(t,"z",function(){return b}),a.d(t,"t",function(){return w}),a.d(t,"A",function(){return k}),a.d(t,"j",function(){return C}),a.d(t,"g",function(){return x}),a.d(t,"y",function(){return $}),a.d(t,"x",function(){return D}),a.d(t,"l",function(){return S}),a.d(t,"p",function(){return q}),a.d(t,"o",function(){return M}),a.d(t,"f",function(){return E}),a.d(t,"n",function(){return j}),a.d(t,"a",function(){return A}),a.d(t,"C",function(){return F});var i=a("8897"),n=a("751a");function r(e){return n["a"].get("".concat(i["a"].baseUrl,"/v2/place/").concat(e,"/ffhosts/count"))}function o(e,t){return n["a"].get("".concat(i["a"].baseUrl,"/v2/place/").concat(e,"/devices"),t)}function s(e,t){return n["a"].get("".concat(i["a"].baseUrl,"/v2/place/").concat(e,"/videos"),t)}function c(e){return n["a"].get("".concat(i["a"].baseUrl,"/v2/place/").concat(e,"/patrol/count"))}function l(e){return n["a"].get("".concat(i["a"].baseUrl,"/v2/alarms/").concat(e.notice_status),e)}function u(e){return n["a"].get("".concat(i["a"].baseUrl,"/v2/place/energy/today"),e)}function p(e,t){return n["a"].del("".concat(i["a"].baseUrl,"/v3/device/unbind?mac=")+e+"&verify_code="+t)}function d(e){return n["a"].post("/gethls.json",e,{timeout:3e4})}function f(e){return n["a"].del("".concat(i["a"].baseUrl,"/v2/video/").concat(e))}function v(e,t){return n["a"].get("".concat(i["a"].baseUrl,"/v2/place/").concat(e,"/patrols"),t)}function m(e,t){return n["a"].get("".concat(i["a"].baseUrl,"/v2/place/").concat(e,"/patrols/history"),t)}function h(e){return n["a"].get("".concat(i["a"].baseUrl,"/v2/device/").concat(e))}function _(e,t){return n["a"].get("".concat(i["a"].baseUrl,"/v2/device/").concat(e,"/alarms"),t)}function g(e){return n["a"].get("".concat(i["a"].baseUrl,"/v2/supervisor/").concat(e))}function y(e,t){return n["a"].putWithJson("".concat(i["a"].baseUrl,"/v2/device/").concat(e,"/config"),t)}function b(e){return n["a"].get("".concat(i["a"].baseUrl,"/v2/ffhost/alarms"),e)}function w(e){return n["a"].get("".concat(i["a"].baseUrl,"/v2/place/").concat(e,"/ffhosts"))}function k(e){return n["a"].del("".concat(i["a"].baseUrl,"/v2/device/").concat(e,"/unbind"))}function C(){return n["a"].get("".concat(i["a"].baseUrl,"/v2/ffhost/brands"))}function x(e){return n["a"].postWithJson("".concat(i["a"].baseUrl,"/v2/device/bind"),e)}function $(e,t){return n["a"].get("".concat(i["a"].baseUrl,"/v2/place/").concat(e,"/electricity/total"),t)}function D(e,t){return n["a"].get("".concat(i["a"].baseUrl,"/v2/place/").concat(e,"/electricity"),t)}function S(e){return n["a"].get("".concat(i["a"].baseUrl,"/v2/device_electricity_report_place"),e)}function q(e){return n["a"].get("".concat(i["a"].baseUrl,"/v2/device_nb_gps"),e)}function M(e){return n["a"].putWithJson("".concat(i["a"].baseUrl,"/v2/device"),e)}function E(e,t){return n["a"].get("".concat(i["a"].baseUrl,"/v2/device/").concat(e,"/status"),t)}function j(e,t){return n["a"].get("".concat(i["a"].baseUrl,"/v2/device/").concat(e,"/history"),t)}function A(e){return n["a"].postWithJson("".concat(i["a"].baseUrl,"/v2/video"),e)}function F(e){return n["a"].putWithJson("".concat(i["a"].baseUrl,"/v2/video"),e)}},ae1e:function(e,t,a){"use strict";var i=a("5a38"),n=a.n(i);n.a},aff0:function(e,t,a){},ca14:function(e,t,a){"use strict";var i=a("25cc"),n=a.n(i);n.a},d9f1e:function(e,t,a){},dfde:function(e,t,a){"use strict";var i=a("5a47"),n=a.n(i);n.a},e742:function(e,t,a){"use strict";var i=a("38e0"),n=a.n(i);n.a},f91c:function(e,t,a){"use strict";var i=a("473f"),n=a.n(i);n.a}}]);
//# sourceMappingURL=chunk-5a9e1d2a.f5c2f568.js.map