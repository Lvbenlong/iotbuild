(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49af59f4"],{"17fb":function(e,t,n){"use strict";var a=n("8329"),i=n.n(a);i.a},5568:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"iotTable"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData}},e._l(e.tableHeader,function(t,a){return"slot"!==t.type?n("el-table-column",{key:a,attrs:{prop:t.prop,width:t.width,label:t.label}}):n("el-table-column",{key:a,attrs:{width:t.width||150,label:t.label},scopedSlots:e._u([{key:"default",fn:function(n){return[e._t("col-"+t.prop,null,{row:n.row,index:n.$index})]}}],null,!0)})}),1),e.showPage?n("div",{staticClass:"pagination-container"},[n("el-pagination",{attrs:{"current-page":e.pagination.page,"page-sizes":[10,20,50,100],"page-size":e.pagination.per_page,layout:"total, sizes, prev, pager, next, jumper",total:e.pagination.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1):e._e()],1)},i=[],s={name:"IotTable",props:{tableData:{type:Array,required:!0},tableHeader:{type:Array,required:!0},loading:{type:Boolean,required:!1},pagination:{type:Object,required:!1},hidepagination:{type:Boolean,required:!1,default:!1}},data:function(){return{}},computed:{showPage:function(){return!this.hidepagination&&!!this.pagination}},methods:{handleSizeChange:function(e){this.pagination.per_page=e,this.$emit("reloaddata")},handleCurrentChange:function(e){console.log(e),this.pagination.page=e,this.$emit("reloaddata")}}},r=s,o=(n("c18f"),n("2877")),l=Object(o["a"])(r,a,i,!1,null,"d6bd296c",null);t["a"]=l.exports},8329:function(e,t,n){},"84c0":function(e,t,n){},8593:function(e,t,n){"use strict";n.d(t,"f",function(){return r}),n.d(t,"d",function(){return o}),n.d(t,"b",function(){return l}),n.d(t,"e",function(){return c}),n.d(t,"c",function(){return u}),n.d(t,"g",function(){return p}),n.d(t,"a",function(){return m}),n.d(t,"h",function(){return d});var a=n("8897"),i=n("751a"),s=n("72bb");function r(e){return i["a"].get("".concat(a["a"].baseUrl,"/v2/companies"),e)}function o(){return i["a"].get("".concat(a["a"].baseUrl,"/v2/roles"))}function l(e){return i["a"].del("".concat(a["a"].baseUrl,"/v2/role/").concat(e))}function c(e){return i["a"].get("".concat(a["a"].baseUrl,"/v2/members?page=").concat(e.page||1,"&per_page=").concat(e.per_page||10),e)}function u(e,t){return i["a"].del("".concat(a["a"].baseUrl,"/v3/member?mid=")+e+"&verify_code="+t)}function p(e){return i["a"].get("".concat(a["a"].baseUrl,"/v2/operations"),e)}function m(e){return i["a"].post("".concat(a["a"].baseUrl,"/v2/company/logo/custom"),e)}function d(e){return i["a"].post("".concat(a["a"].baseUrl,"/v2/imei/mac/excel"),e,{headers:{"X-API-TOKEN":Object(s["a"])(a["a"].token)}})}},"9f84":function(e,t,n){},c18f:function(e,t,n){"use strict";var a=n("9f84"),i=n.n(a);i.a},dab0:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"titleHeader"},[n("h3",[e._v(e._s(e.title))])])},i=[],s={name:"TitleHeader",props:["title"],data:function(){return{}}},r=s,o=(n("e4fc"),n("2877")),l=Object(o["a"])(r,a,i,!1,null,"2b873fd4",null);t["a"]=l.exports},e4fc:function(e,t,n){"use strict";var a=n("84c0"),i=n.n(a);i.a},eac5:function(e,t,n){"use strict";n.r(t);var a,i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"equipment"},[n("title-header",{attrs:{title:"批量导入NB设备"}}),n("div",{staticClass:"tools"},[n("el-row",{attrs:{gutter:24}},[n("el-col",{attrs:{span:15}},[n("el-button",{staticClass:"blue",attrs:{type:"primary"},on:{click:e.opennbeqment}},[e._v("新增设备")]),n("el-button",{staticClass:"blue",attrs:{type:"primary"},on:{click:e.download}},[e._v("下载EXCEL模板")]),e.xlsx?n("el-button",{staticClass:"blue",attrs:{type:"primary"},on:{click:e.inputfileclick}},[e._v("导入EXCEL")]):e._e(),n("el-select",{staticClass:"ml10 e-selects",attrs:{placeholder:"请选择设备类型"},model:{value:e.queryNBType,callback:function(t){e.queryNBType=t},expression:"queryNBType"}},e._l(e.NBTypes,function(e){return n("el-option",{key:e.display,attrs:{label:e.display,value:e}})}),1)],1)],1)],1),n("input",{staticClass:"inputfile",attrs:{type:"file",id:"inputfile"},on:{change:function(t){return e.importf(t)}}}),e.nbeqments.length>0?n("div",{staticClass:"exceldata"},[n("iot-table",{attrs:{tableHeader:e.tableHeader,tableData:e.nbeqments},scopedSlots:e._u([{key:"col-confirm",fn:function(t){return n("div",{},[n("el-button",{attrs:{type:"text",size:"small"},on:{click:function(n){return e.detalnbeqment(t.index)}}},[e._v("删除")])],1)}}],null,!1,1161048758)}),n("div",{staticClass:"mt10"},[n("el-button",{staticClass:"blue",attrs:{type:"primary"},on:{click:e.subnbeqment}},[e._v("提交")])],1)],1):e._e(),n("div",{directives:[{name:"show",rawName:"v-show",value:e.shownews,expression:"shownews"}],attrs:{id:"neweqment"}},[n("div",{staticClass:"pop-content"},[n("p",{staticClass:"popup-title"},[e._v("\n          新增设备\n        ")]),n("div",{staticClass:"popup-con"},[n("ul",[n("li",{},[n("span",[e._v("MAC：")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.nbeqment.mac,expression:"nbeqment.mac"}],attrs:{type:"text",placeholder:"请输入设备MAC号码"},domProps:{value:e.nbeqment.mac},on:{input:function(t){t.target.composing||e.$set(e.nbeqment,"mac",t.target.value)}}}),n("small",{staticStyle:{display:"none"}},[e._v("*请输入正确的设备MAC号码")])]),n("li",{},[n("span",[e._v("IMEI：")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.nbeqment.imei,expression:"nbeqment.imei"}],attrs:{type:"text",placeholder:"请输入设备IMEI号码"},domProps:{value:e.nbeqment.imei},on:{input:function(t){t.target.composing||e.$set(e.nbeqment,"imei",t.target.value)}}}),n("small",{staticStyle:{display:"none"}},[e._v("*请输入正确的设备IMEI号码")])]),n("li",{},[n("span",[e._v("IMSI：")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.nbeqment.imsi,expression:"nbeqment.imsi"}],attrs:{type:"text",placeholder:"请输入设备IMSI号码"},domProps:{value:e.nbeqment.imsi},on:{input:function(t){t.target.composing||e.$set(e.nbeqment,"imsi",t.target.value)}}}),n("small",{staticStyle:{display:"none"}},[e._v("*请输入正确的设备IMSI号码")])]),n("li",[n("button",{staticClass:"btn btn-middle cancel",on:{click:e.closenbeqment}},[e._v("取消")]),n("button",{staticClass:"btn btn-middle yes",on:{click:e.addnbeqment}},[e._v("确定")])])])]),n("span",{staticClass:"layui-layer-setwin"},[n("a",{staticClass:"close-popup layui-layer-close layui-layer-close1",attrs:{href:"javascript:;"},on:{click:e.closenbeqment}},[n("span",{staticClass:"iconfont iconguanbi close-iconfont"})])])])])],1)},s=[],r=(n("ac6a"),n("456d"),n("dab0")),o=n("8897"),l=n("3389"),c=n("5568"),u=n("8593"),p=!1,m={name:"Equipment",components:{TitleHeader:r["a"],iotTable:c["a"]},data:function(){return{queryNBType:"",nbeqments:[],NBTypes:Object.keys(o["a"].NBType).map(function(e){return{code:e,display:o["a"].NBType[e]}}),xlsx:!0,index:0,nbsTotal:1e3,shownews:!1,nbeqment:{mac:"",imei:"",imsi:""},pagination:{page:1,per_page:10,total:0},tableHeader:[{prop:"mac",label:"MAC"},{prop:"imei",label:"IMEI"},{prop:"imsi",label:"IMSI"},{prop:"confirm",label:"操作",type:"slot"}]}},methods:{download:function(){window.location.href="http://91mogo.com/download/mac-imei.xlsx"},opennbeqment:function(){this.shownews=!0,this.nbeqment.mac="",this.nbeqment.imei=""},detalnbeqment:function(e){this.nbeqments.splice(e,1)},inputfileclick:function(){var e=document.getElementById("inputfile");e.click()},closenbeqment:function(){this.shownews=!1},addnbeqment:function(){var e=this.nbeqment,t=e.mac,n=e.imei,a=e.imsi,i=/^[D|d][A-Fa-f0-9]{11}$/,s=/^[0-9]{15}$/,r=/^[0-9]{15}$/;if(i.test(t))if(s.test(n))if(r.test(a)){var o=this.nbeqments.length&&this.nbeqments.filter(function(e,n){return e.mac==t}),c=this.nbeqments.length&&this.nbeqments.filter(function(e,t){return e.imei==n});if(o.length>0)l["a"].error("请输入唯一的mac值");else if(c.length>0)l["a"].error("请输入唯一的imei值");else{var u={mac:t,imei:n,imsi:a};this.nbeqments.push(u),this.shownews=!1}}else l["a"].error("请输入正确格式的imsi值");else l["a"].error("请输入正确格式的imei值");else l["a"].error("请输入正确格式的mac值")},subnbeqment:function(){var e=this;if(this.nbeqments.length<=this.nbsTotal){var t=this.generateRole();if(!t.device_type)return void l["a"].error("请选择设备类型！");Object(u["h"])(t).then(function(t){200==t.status&&(l["a"].success("请求成功",t.data),e.nbeqments=[])},function(e){l["a"].error("保存失败",l["a"].findErrorMsg(e))})}else this.forList()},forList:function(){for(var e=this.generateRole(),t=this.index;t<e.length;t++){for(var n=e[t],a=[],i=0;i<n.length;i++)a=0==i?"'"+n[i].imei+"':'"+n[i].mac+"'":a+",'"+n[i].imei+"':'"+n[i].mac+"'";if(a="{"+a+"}",this.index>n.length)return;if(this.index==e.length)return;this.splitLoad(a);break}},generateRole:function(){for(var e=[],t=0;t<this.nbeqments.length;t++)e.push({mac:this.nbeqments[t].mac+"",imei:this.nbeqments[t].imei+"",imsi:this.nbeqments[t].imei+""});var n=this.queryNBType&&this.queryNBType.code;return this.nbeqments.length<=this.nbsTotal?{data:e,device_type:n}:this.SplitArray(this.nbsTotal,this.nbeqments)},splitLoad:function(e){var t=this.queryNBType.code;if(t){var n=this;Object(u["h"])({data:e,device_type:t}).then(function(e){200==e.status&&(l["a"].success("请求成功",e.data),n.index++,n.forList())},function(e){l["a"].error("保存失败",l["a"].findErrorMsg(e))})}else l["a"].error("请选择设备类型！")},SplitArray:function(e,t){var n=[];while(t.length>e)n.push(t.splice(0,e));return t.length>0&&n.push(t),n},importf:function(e){var t=this;if(e.target.files){var n=e.target.files[0],i=new FileReader;i.onload=function(e){var n=e.target.result;a=p?XLSX.read(btoa(fixdata(n)),{type:"base64"}):XLSX.read(n,{type:"binary"}),t.nbeqments=t.nbeqments.concat(XLSX.utils.sheet_to_json(a.Sheets[a.SheetNames[0]])),t.xlsx=!1},p?i.readAsArrayBuffer(n):i.readAsBinaryString(n)}}}},d=m,f=(n("17fb"),n("2877")),b=Object(f["a"])(d,i,s,!1,null,"6ed6c161",null);t["default"]=b.exports}}]);
//# sourceMappingURL=chunk-49af59f4.b35ee9b5.js.map